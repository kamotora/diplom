<!doctype html><html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org"      xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="auto" class="h-100"><head>    <th:block th:replace="fragments/head :: head('Профиль')"/>    <meta name="_csrf" th:content="${_csrf.token}"/>    <!-- default header name is X-CSRF-TOKEN -->    <meta name="_csrf_header" th:content="${_csrf.headerName}"/></head><body class="d-flex flex-column h-100"><header>    <div th:replace="fragments/navbars :: selectNavbar"></div></header><main role="main" class="flex-shrink-0">    <div class="container" id = "content">        <div class = "row">            <!--            <div class="col-lg-4">                <div class = "panel panel-default">                    <div class = "panel-body">                        <div class="profile-img">                            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS52y5aInsxSm31CvHOFHWujqUx_wWTS9iM6s7BAm21oEN_RiGoog" alt=""/>                            <div class="file btn btn-lg btn-primary">                                Изменить фото профиля                                <input type="file" name="file"/>                            </div>                        </div>                    </div>                </div>            </div>            -->            <div class = "col-lg-12">                <div class = "panel">                    <div class = "panel-body">                        <h4>О Сотруднике</h4>                    </div>                    <h4>Личная информация</h4>                    <form th:object="${user}" th:method="post" name="profileForm">                        <table class="table table-th-block">                            <tbody>                                <tr><td class="active">ФИО:</td><td th:text = "*{name}"></td></tr>                                <tr><td class="active">Номер:</td><td th:text = "*{number}"></td></tr>                                <tr><td class="active">Логин:</td><td th:text = "*{username}"></td></tr>                                <tr><td class="active">Пароль:</td><td><button id="passwordButton" type="button" class="btn btn-primary mb-2" data-toggle="modal" data-target="#changePassModal">Сменить пароль</button></td></tr>                                <tr><td class="active">Email:</td><td th:text = "*{email}"></td></tr>                                <tr><td class="active">Роль:</td><td th:text = "*{role.getAuthority()}"></td></tr>                            </tbody>                        </table>                        <!-- <button class="btn btn-lg btn-primary btn-block" type="submit">Сохранить</button> -->                    </form>                </div>            </div>        </div>    </div>    <!-- Modal -->    <div class="modal fade" id="changePassModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"         aria-hidden="true">        <div class="modal-dialog" role="document">            <div class="modal-content">                <div class="modal-header">                    <h5 class="modal-title" id="exampleModalLabel">Смена пароля</h5>                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">                        <span aria-hidden="true">&times;</span>                    </button>                </div>                <form name="modal">                    <div class="modal-body">                        <div id="message" class="alert alert-danger" role="alert">                            Это уведомление об опасности — check it out!                        </div>                        <div class="mb-3">                            <input type="password" class="form-control" id="oldPassword" th:field="${user.oldPassword}"                                   placeholder="Старый пароль"                                   required>                        </div>                        <div class="mb-3">                            <input type="password" class="form-control" id="password1" th:field="${user.password1}"                                   placeholder="Новый пароль" required>                        </div>                        <div class="mb-3">                            <input type="password" class="form-control" id="password2" th:field="${user.password2}"                                   placeholder="Повторите новый пароль"                                   required>                        </div>                    </div>                    <div class="modal-footer">                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>                        <button id="savePassword" type="button" class="btn btn-primary">Сохранить</button>                    </div>                </form>            </div>        </div>    </div></main><footer th:replace="fragments/footer :: footer"></footer><script>    let message = $('#message');    message.hide();    $('#savePassword').click(function () {        let oldPassword = $('#oldPassword'), password1 = $('#password1'), password2 = $('#password2');        if (!oldPassword.val() || !password1.val() || !password2.val()) {            message.text("Не все поля заполнены");            message.show()            return false;        }        if (password1.val() !== password2.val()) {            message.text("Новые пароли не совпадают");            message.show();            return false;        } else {            //Смена пароля            //Тратата            const token = $("meta[name='_csrf']").attr("content");            const header = $("meta[name='_csrf_header']").attr("content");            $.ajax({                type: "POST",                headers: {                    'Accept': 'text/plain',                    'Content-Type': 'application/json'                },                data: JSON.stringify({                    oldPassword: oldPassword.val(),                    password1: password1.val(),                    password2: password2.val()                }),                url: "/profile/changePass",                beforeSend: function (xhr) {                    // here it is                    xhr.setRequestHeader(header, token);                },                success: function (data) {                    console.log(data);                    alert(data);                    //Очищаем и Закрываем форму                    password1.val('');                    password2.val('');                    oldPassword.val('');                    message.hide();                    $('#changePassModal').modal('hide');                }                ,                error: function (data) {                    console.log(data);                    message.show();                    message.text(data.responseText);                }            });        }    })</script></body></html>