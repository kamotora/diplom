<!doctype html><html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org"      lang="auto" class="h-100"><head>    <th:block            th:replace="fragments/head :: headForTable(${rule.id} ? ( ${isView != null} ? 'Просмотр правила ' : 'Редактирование правила ') + ${rule.name} : 'Добавить правило')">    </th:block>    <meta name="_csrf" th:content="${_csrf.token}"/>    <!-- default header name is X-CSRF-TOKEN -->    <meta name="_csrf_header" th:content="${_csrf.headerName}"/></head><body class="d-flex flex-column h-100"><header>    <div th:replace="fragments/navbars :: selectNavbar"></div></header><main role="main" class="flex-shrink-0">    <div class="container">        <div class="mb-3 row">            <h3 th:text="${rule.id} ? ( ${isView != null} ? 'Просмотр правила ' : 'Редактирование правила ') + ${rule.name} : 'Добавить правило'"></h3>        </div>        <div id="messages" th:replace="fragments/messages :: messages"></div>        <form id="ruleForm" name="ruleForm" th:action="@{/rule}" method="post" th:object="${rule}">            <div class="form-group">                <input type="hidden" id="id" th:name="id" th:value="*{id}"/>            </div>            <div class="mb-3 form-group">                <label class="font-weight-bold" for="name">Название</label>                <input type="text" class="form-control" id="name" th:field="*{name}"                       placeholder="Введите название правила" required th:disabled="${isView != null}">            </div>            <div id="manager">                <label class="font-weight-bold">Номер менеджера</label>                <div class="row mb-3">                    <!--Скрываем, если просмотр и нечего вывести-->                    <div class="col" th:hidden="${isView != null && #strings.isEmpty(rule.managerNumber)}">                        <label class="" for="number">Введите номер</label>                        <input maxlength="11" minlength="3" type="tel" class="form-control" id="number"                               placeholder="Номер" th:field="*{managerNumber}" th:disabled="${isView != null}">                    </div>                    <div class="col-md-auto" th:hidden="${isView != null}">                        <label class="">или</label>                    </div>                    <div class="col" th:hidden="${isView != null && rule.manager == null}">                        <label class="" for="managerSelect">Выберите менеджера</label>                        <select class="form-control" id="managerSelect" th:field="*{manager}"                                th:disabled="${isView != null}">                            <option value="" th:selected="${rule == null}">Выберите менеджера ...</option>                            <option th:each="user : ${users}"                                    th:value="${user.getId()}"                                    th:text="${user.getFirstRoleName() + ': ' +user.getName() + ' Телефон: ' + user.getNumber()}"></option>                        </select>                    </div>                </div>            </div>            <div class="mb-3 form-check" id="smartCheck" style="padding-left: 20px;">                <input type="checkbox" class="form-check-input" id="isSmart" th:name="isSmart" th:field="*{isSmart}"                       th:disabled="${isView != null}"/>                <label class="font-weight-bold form-check-label" for="isSmart">Умная маршрутизация</label>            </div>            <label class="font-weight-bold">Список клиентов</label>            <div class="form-group mb-3">                <div id="toolbar">                    <div class="mb-1 form-group form-check">                        <input id="forAll" type="checkbox" class="form-check-input" th:disabled="${isView != null}">                        <label class=" form-check-label" for="forAll" th:field="*{isForAllClients}">Для всех клиентов</label>                    </div>                    <div id="clients">                        <!--                    todo добавить скрытие столбца действий при режиме просмотра-->                        <button id="addClient" type="button" class="btn btn-primary mb-2" data-toggle="modal"                                data-target="#addClientDialog" th:hidden="${isView != null}">                            Добавить                        </button>                        <table id="table"                               data-locale="ru-RU">                        </table>                    </div>                </div>            </div>            <label class="font-weight-bold">Время действия</label>            <div class="form-group mb-3">                <select multiple class="form-control" id="roleSelect" th:field="*{days}" required                        th:disabled="${isView != null}">                    <option th:each="day : ${allDays}"                            th:value="${day}"                            th:text="${day.getName()}"></option>                </select>            </div>            <div class="col-4 input-group">                <label for="timeStart" class="col-form-label">C</label>                <input class="form-control mx-sm-3" type="time" size="10" id="timeStart" th:field="*{timeStartString}"                       required th:disabled="${isView != null}">                <label for="timeFinish" class="col-form-label">По</label>                <input class="form-control mx-sm-3" type="time" size="300" id="timeFinish"                       th:field="*{timeFinishString}" required th:disabled="${isView!= null}">            </div>            <hr class="mb-4">            <button id="saveRuleButton" class="btn btn-lg btn-primary btn-block" type="submit">Сохранить</button>        </form>    </div></main><!-- Модальное окно для добавления клиента в таблицу  и вывода инфы о нём --><div th:fragment="addClientDialog" class="modal fade" id="addClientDialog" tabindex="-1" role="dialog"     aria-labelledby="exampleModalLabel"     aria-hidden="true">    <div class="modal-dialog modal-xl" role="document">        <div class="modal-content">            <div class="modal-header">                <h5 class="modal-title" id="exampleModalLabel">Добавить клиента</h5>                <button type="button" class="close" data-dismiss="modal" aria-label="Close">                    <span aria-hidden="true">&times;</span>                </button>            </div>            <div class="modal-body">                <h5>Добавьте существующего клиента</h5>                <table id="modal_table"                       data-locale="ru-RU"                       class="table table-bordered table-hover table-striped"                       data-pagination="true"                       data-page-size="3"                       data-page-list="[3,10, 25, all]">                </table>                <br><h5>ИЛИ</h5><br>                <form id="addNewClientForm">                    <h5>Добавьте нового клиента</h5>                    <div th:if="${badMessageModal}" id="badMessageModal" th:name="badMessage"                         class="alert alert-danger mt-lg-5" role="alert"                         th:text="${badMessageModal}"></div>                    <div th:if="${goodMessageModal}" id="goodMessageModal" th:name="goodMessage"                         class="alert alert-success mt-lg-5"                         role="alert"                         th:text="${goodMessageModal}"></div>                    <div class="mb-3">                        <input type="hidden" id="id_client" name="id" class="form-control"/>                        <label id="numLabel" class="" for="number_client">Номер клиента</label>                        <input type="tel" id="number_client" pattern="[0-9]+" name="number" class="form-control"                               placeholder="79831234567" required/>                        <div class="invalid-feedback">                            Введите Номер                        </div>                    </div>                    <div class="mb-3">                        <label id="FIOLabel" class="" for="name">ФИО</label>                        <input type="tel" id="name_client" name="name" class="form-control"                               placeholder="Иванов Иван Иванович" required/>                        <div class="invalid-feedback">                            Введите ФИО                        </div>                    </div>                    <button id="saveClient" type="submit" class="btn btn-primary">Сохранить и добавить в таблицу</button>                </form>            </div>            <div class="modal-footer">                <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть окно</button>            </div>        </div>    </div></div><!-- Modal --><div th:replace="fragments/dialogs ::askDeleteDialog"></div><footer class="footer navbar-fixed-bottom mt-auto py-3" th:include="fragments/footer :: footerForTables"></footer><script type="text/javascript" th:src="@{/js/addRuleClientsTable.js}"></script></body></html>